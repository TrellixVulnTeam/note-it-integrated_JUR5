{"ast":null,"code":"import _asyncToGenerator from \"/home/nehakothari/Desktop/Note-it-integrated/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/rest-api.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../navbar/navbar.component\";\nexport class UploadComponent {\n  constructor(_api, router) {\n    this._api = _api;\n    this.router = router;\n    this.progress = {\n      percentage: 0\n    };\n  }\n\n  ngOnInit() {\n    $('form').jsonForm({\n      schema: {\n        chapters: {\n          type: \"array\",\n          items: {\n            type: \"object\",\n            title: \"-----------------------------------------\",\n            properties: {\n              \"chapterNumber\": {\n                \"type\": \"integer\",\n                \"title\": \"Chapter Number\",\n                \"required\": true\n              },\n              \"chapterName\": {\n                \"type\": \"string\",\n                \"title\": \"Chapter Name\",\n                \"required\": true\n              },\n              \"startPage\": {\n                \"type\": \"integer\",\n                \"title\": \"Start Page\",\n                \"required\": true\n              },\n              \"endPage\": {\n                \"type\": \"integer\",\n                \"title\": \"End Page\",\n                \"required\": true\n              },\n              \"description\": {\n                \"type\": \"string\",\n                \"title\": \"Description\",\n                \"required\": true\n              }\n            }\n          }\n        }\n      },\n      onSubmit: function (errors, values) {\n        if (errors) {\n          console.log(errors);\n        } else {\n          this.chapters = values.chapters;\n          console.log(values.chapters);\n          localStorage.setItem(\"chapters\", JSON.stringify(values.chapters));\n          Swal.fire('Chapters Submitted!', 'Click on Save Changes!', 'success');\n        }\n      }\n    });\n  }\n\n  selectFile(event) {\n    console.log(\"Came to selected file\");\n    this.selectedFiles = event.target.files;\n  }\n\n  upload() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.chapters = localStorage.chapters;\n      console.log(\"Chapters\", JSON.parse(_this.chapters));\n      _this.progress.percentage = 0;\n      _this.currentFileUpload = yield _this.selectedFiles.item(0);\n      console.log(\"currentFileUpload\", _this.currentFileUpload);\n      let json = {}; // get isbn\n\n      let isbnNumber = document.getElementById(\"isbn\");\n      json.isbnNumber = isbnNumber.value; // get title\n\n      let bookName = document.getElementById(\"title\");\n      json.bookName = bookName.value; // author\n\n      let author = document.getElementById(\"author\");\n      json.author = author.value; // publisher\n\n      let publisher = document.getElementById(\"publisher\");\n      json.publisher = publisher.value; // yearOfRelease\n\n      let yearOfRelease = document.getElementById(\"yearOfRelease\");\n      json.yearOfRelease = yearOfRelease.value; // Image Location\n\n      let imageLocation = document.getElementById(\"imageLocation\");\n      json.imageLocation = imageLocation.value; // Description\n\n      let description = document.getElementById(\"description\");\n      json.description = description.value; // my obj\n\n      console.log(\"OBJJJ\", json);\n      let formData = new FormData();\n      formData.set(\"json\", JSON.stringify(json));\n      let file = document.getElementById(\"file\");\n      let file2 = file.files[0];\n      console.log(\"BEFOREEE\", file2);\n\n      if (file2 !== undefined) {\n        console.log(\"BEFOREEE appended\");\n        formData.append(\"file\", file2);\n      }\n\n      let response = yield _this._api.push_final(formData);\n      console.log(\"RESPONSEEEEEE\", response); //   {\n      //     \"bookId\": 1,\n      //     \"bookName\": \"Dummy\",\n      //     \"isbnNumber\": null,\n      //     \"author\": \"neha\",\n      //     \"publisher\": null,\n      //     \"yearOfRelease\": null,\n      //     \"imageLocation\": null,\n      //     \"uploadedByUser\": \"Neha Kothari\",\n      //     \"error\": null,\n      //     \"chapters\" : [\n      //     {\n      //         \"chapterNumber\" : \"1\",\n      //         \"chapterName\" : \"Hello World!\",\n      //         \"startPage\" : \"1\",\n      //         \"endPage\" : \"10\",\n      //         \"description\" : \"This is the first chapter!\"\n      //     },\n      //     {\n      //         \"chapterNumber\" : \"2\",\n      //         \"chapterName\" : \"okay World\",\n      //         \"startPage\" : \"11\",\n      //         \"endPage\" : \"20\",\n      //         \"description\" : \"This is the 2nd chapter!\"\n      //     },\n      //     {\n      //         \"chapterNumber\" : \"3\",\n      //         \"chapterName\" : \"Goodbye\",\n      //         \"startPage\" : \"31\",\n      //         \"endPage\" : \"40\",\n      //         \"description\" : \"This is the last chapter!\"\n      //     }\n      // ]\n      // }\n      // Sending the chapters:\n\n      if (_this.chapters) {\n        console.log(\"now going to chapters\");\n        let obj = JSON.parse(JSON.stringify(json));\n        obj.bookId = response.bookId;\n        obj.uploadedByUser = \"user\";\n        obj.chapters = JSON.parse(_this.chapters); // console.log(\"Split obj\", obj);\n\n        let response1 = _this._api.push_chapters_to_backend(obj);\n\n        if (response1) {\n          Swal.fire('Yayy!', 'Book Submitted!', 'success');\n        } // route to dashboard.\n\n\n        _this.router.navigate(['home']);\n      }\n    })();\n  }\n\n}\n\nUploadComponent.ɵfac = function UploadComponent_Factory(t) {\n  return new (t || UploadComponent)(i0.ɵɵdirectiveInject(i1.RestApiService), i0.ɵɵdirectiveInject(i2.Router));\n};\n\nUploadComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: UploadComponent,\n  selectors: [[\"app-upload\"]],\n  decls: 55,\n  vars: 1,\n  consts: [[1, \"container\", 2, \"max-width\", \"70vw\"], [1, \"row\", \"text-center\", \"mt-4\"], [1, \"row\", \"source-sans-pro\"], [1, \"input-group\", \"mb-3\"], [1, \"input-group-text\"], [\"type\", \"text\", \"id\", \"isbn\", \"aria-describedby\", \"isbn\", 1, \"form-control\"], [\"type\", \"text\", \"id\", \"title\", \"aria-describedby\", \"title\", 1, \"form-control\"], [\"type\", \"text\", \"id\", \"author\", \"aria-describedby\", \"author\", 1, \"form-control\"], [\"type\", \"text\", \"id\", \"publisher\", \"aria-describedby\", \"publisher\", 1, \"form-control\"], [\"type\", \"text\", \"id\", \"yearOfRelease\", \"aria-describedby\", \"yearOfRelease\", 1, \"form-control\"], [\"type\", \"text\", \"id\", \"imageLocation\", \"aria-describedby\", \"imageLocation\", 1, \"form-control\"], [\"type\", \"text\", \"aria-describedby\", \"description\", \"id\", \"description\", 1, \"form-control\"], [\"type\", \"file\", \"id\", \"file\", 1, \"form-control\", 3, \"change\"], [\"data-bs-toggle\", \"modal\", \"data-bs-target\", \"#exampleModal\", 1, \"btn\", \"btn-danger\"], [1, \"btn\", \"btn-primary\", \"mx-3\", 3, \"disabled\", \"click\"], [\"id\", \"exampleModal\", \"tabindex\", \"-1\", \"aria-labelledby\", \"exampleModalLabel\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\"], [1, \"modal-content\"], [1, \"modal-header\"], [\"id\", \"exampleModalLabel\", 1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [1, \"modal-body\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-secondary\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-primary\"]],\n  template: function UploadComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-navbar\");\n      i0.ɵɵelementStart(1, \"div\", 0);\n      i0.ɵɵelementStart(2, \"div\", 1);\n      i0.ɵɵelementStart(3, \"h2\");\n      i0.ɵɵtext(4, \"Upload Book\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"div\", 2);\n      i0.ɵɵelementStart(6, \"div\", 3);\n      i0.ɵɵelementStart(7, \"span\", 4);\n      i0.ɵɵtext(8, \"ISBN\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(9, \"input\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"div\", 3);\n      i0.ɵɵelementStart(11, \"span\", 4);\n      i0.ɵɵtext(12, \"Title\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(13, \"input\", 6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"div\", 3);\n      i0.ɵɵelementStart(15, \"span\", 4);\n      i0.ɵɵtext(16, \"Author\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(17, \"input\", 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"div\", 3);\n      i0.ɵɵelementStart(19, \"span\", 4);\n      i0.ɵɵtext(20, \"Publisher\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(21, \"input\", 8);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"div\", 3);\n      i0.ɵɵelementStart(23, \"span\", 4);\n      i0.ɵɵtext(24, \"Year of Release\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(25, \"input\", 9);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"div\", 3);\n      i0.ɵɵelementStart(27, \"span\", 4);\n      i0.ɵɵtext(28, \"Image Location\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(29, \"input\", 10);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"div\", 3);\n      i0.ɵɵelementStart(31, \"span\", 4);\n      i0.ɵɵtext(32, \"Description\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(33, \"input\", 11);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"div\", 3);\n      i0.ɵɵelementStart(35, \"input\", 12);\n      i0.ɵɵlistener(\"change\", function UploadComponent_Template_input_change_35_listener($event) {\n        return ctx.selectFile($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(36, \"button\", 13);\n      i0.ɵɵtext(37, \"Split book?\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(38, \"button\", 14);\n      i0.ɵɵlistener(\"click\", function UploadComponent_Template_button_click_38_listener() {\n        return ctx.upload();\n      });\n      i0.ɵɵtext(39, \"Add book\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(40, \"div\", 15);\n      i0.ɵɵelementStart(41, \"div\", 16);\n      i0.ɵɵelementStart(42, \"div\", 17);\n      i0.ɵɵelementStart(43, \"div\", 18);\n      i0.ɵɵelementStart(44, \"h5\", 19);\n      i0.ɵɵtext(45, \"Split Book into Chapters\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(46, \"button\", 20);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(47, \"div\", 21);\n      i0.ɵɵelement(48, \"form\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(49, \"div\", 22);\n      i0.ɵɵelementStart(50, \"button\", 23);\n      i0.ɵɵtext(51, \"Close\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(52, \"button\", 24);\n      i0.ɵɵtext(53, \"Save changes\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(54, \"form\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(38);\n      i0.ɵɵproperty(\"disabled\", !ctx.selectedFiles);\n    }\n  },\n  directives: [i3.NavbarComponent],\n  styles: [\"._jsonform-array-addmore[_ngcontent-%COMP%] {\\n  color: black;\\n  background-color: black;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwbG9hZC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFlBQUE7RUFDQSx1QkFBQTtBQUNKIiwiZmlsZSI6InVwbG9hZC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5fanNvbmZvcm0tYXJyYXktYWRkbW9yZSB7XG4gICAgY29sb3I6IGJsYWNrO1xuICAgIGJhY2tncm91bmQtY29sb3I6IGJsYWNrO1xufVxuIl19 */\"]\n});","map":{"version":3,"sources":["/home/nehakothari/Desktop/Note-it-integrated/Frontend/src/app/components/upload/upload.component.ts","/home/nehakothari/Desktop/Note-it-integrated/Frontend/src/app/components/upload/upload.component.html"],"names":[],"mappings":"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","sourcesContent":["import { HttpEventType, HttpResponse } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { RestApiService } from 'src/app/services/rest-api.service';\nimport Swal from 'sweetalert2';\ndeclare var $: any;\n\n@Component({\n  selector: 'app-upload',\n  templateUrl: './upload.component.html',\n  styleUrls: ['./upload.component.scss']\n})\nexport class UploadComponent implements OnInit {\n\n  constructor( private _api:RestApiService, public router: Router) { }\n  selectedFiles: any;\n  progress: { percentage: number } = { percentage: 0 };\n  currentFileUpload: any;\n  chapters: any;\n\n  ngOnInit(): void {\n    $('form').jsonForm({\n      schema: {\n        chapters: {\n          type: \"array\",\n          items: {\n            type: \"object\",\n            title: \"-----------------------------------------\",\n            properties: {\n              \"chapterNumber\": {\n                \"type\": \"integer\",\n                \"title\": \"Chapter Number\",\n                \"required\": true\n              },\n              \"chapterName\": {\n                \"type\": \"string\",\n                \"title\": \"Chapter Name\",\n                \"required\": true\n              },\n              \"startPage\": {\n                \"type\": \"integer\",\n                \"title\": \"Start Page\",\n                \"required\": true\n              },\n              \"endPage\": {\n                \"type\": \"integer\",\n                \"title\": \"End Page\",\n                \"required\": true\n              },\n              \"description\": {\n                \"type\": \"string\",\n                \"title\": \"Description\",\n                \"required\": true\n              },\n            }\n          }\n        }\n      },\n      onSubmit: function (errors:any, values: any){\n\n        if (errors) {\n          console.log(errors);\n        }\n        else {          \n          this.chapters = values.chapters;\n          console.log(values.chapters);\n          localStorage.setItem(\"chapters\", JSON.stringify(values.chapters));\n\n          Swal.fire(\n            'Chapters Submitted!',\n            'Click on Save Changes!',\n            'success'\n          )\n        }\n      }\n    });\n  }\n\n  selectFile(event:any) {\n    console.log(\"Came to selected file\");\n    \n    this.selectedFiles = event.target.files;\n  }\n\n  async upload() {\n    \n    this.chapters = localStorage.chapters\n    console.log(\"Chapters\", JSON.parse(this.chapters));\n    \n    \n    this.progress.percentage = 0;\n    this.currentFileUpload = await this.selectedFiles.item(0);\n    console.log(\"currentFileUpload\",this.currentFileUpload);\n\n    let json:any = {}\n\n    // get isbn\n    let isbnNumber:any = document.getElementById(\"isbn\")\n    json.isbnNumber = isbnNumber.value\n\n    // get title\n    let bookName:any = document.getElementById(\"title\")\n    json.bookName = bookName.value\n\n    // author\n    let author:any = document.getElementById(\"author\")\n    json.author = author.value\n\n    // publisher\n    let publisher :any= document.getElementById(\"publisher\")\n    json.publisher = publisher.value\n\n    // yearOfRelease\n    let yearOfRelease:any = document.getElementById(\"yearOfRelease\");\n    json.yearOfRelease = yearOfRelease.value\n\n    // Image Location\n    let imageLocation:any = document.getElementById(\"imageLocation\");\n    json.imageLocation = imageLocation.value\n\n    // Description\n    let description:any = document.getElementById(\"description\");\n    json.description = description.value\n\n    // my obj\n    console.log(\"OBJJJ\",json);\n    \n    \n    let formData = new FormData();\n    formData.set(\"json\", JSON.stringify(json));\n    let file:any = document.getElementById(\"file\")\n    let file2 = file.files[0];\n    console.log(\"BEFOREEE\", file2);\n    \n    if (file2 !== undefined) {\n      console.log(\"BEFOREEE appended\");\n      formData.append(\"file\", file2);\n    }\n    \n    let response:any = await this._api.push_final(formData);\n    console.log(\"RESPONSEEEEEE\", response);\n    \n    \n  //   {\n  //     \"bookId\": 1,\n  //     \"bookName\": \"Dummy\",\n  //     \"isbnNumber\": null,\n  //     \"author\": \"neha\",\n  //     \"publisher\": null,\n  //     \"yearOfRelease\": null,\n  //     \"imageLocation\": null,\n  //     \"uploadedByUser\": \"Neha Kothari\",\n  //     \"error\": null,\n  //     \"chapters\" : [\n  //     {\n  //         \"chapterNumber\" : \"1\",\n  //         \"chapterName\" : \"Hello World!\",\n  //         \"startPage\" : \"1\",\n  //         \"endPage\" : \"10\",\n  //         \"description\" : \"This is the first chapter!\"\n  //     },\n  //     {\n  //         \"chapterNumber\" : \"2\",\n  //         \"chapterName\" : \"okay World\",\n  //         \"startPage\" : \"11\",\n  //         \"endPage\" : \"20\",\n  //         \"description\" : \"This is the 2nd chapter!\"\n  //     },\n  //     {\n  //         \"chapterNumber\" : \"3\",\n  //         \"chapterName\" : \"Goodbye\",\n  //         \"startPage\" : \"31\",\n  //         \"endPage\" : \"40\",\n  //         \"description\" : \"This is the last chapter!\"\n  //     }\n  // ]\n  // }\n    // Sending the chapters:\n    if(this.chapters){\n      console.log(\"now going to chapters\");\n      \n      let obj = JSON.parse(JSON.stringify(json));\n      obj.bookId = response.bookId;\n      obj.uploadedByUser = \"user\"\n      obj.chapters = JSON.parse(this.chapters);\n\n      // console.log(\"Split obj\", obj);\n      let response1:any = this._api.push_chapters_to_backend(obj);\n      if(response1){\n        Swal.fire(\n          'Yayy!',\n          'Book Submitted!',\n          'success'\n        )\n      }\n      // route to dashboard.\n    this.router.navigate(['home']);\n      \n    }\n  }\n\n\n}\n","<app-navbar></app-navbar>\n\n<div class=\"container\" style=\"max-width: 70vw;\">\n    <div class=\"row text-center mt-4\">\n        <h2>Upload Book</h2>\n    </div>\n\n    <div class=\"row source-sans-pro\">\n        <div class=\"input-group mb-3\">\n            <span class=\"input-group-text\">ISBN</span>\n            <input type=\"text\" class=\"form-control\" id=\"isbn\" aria-describedby=\"isbn\">\n          </div>\n\n          <div class=\"input-group mb-3\">\n            <span class=\"input-group-text\">Title</span>\n            <input type=\"text\" class=\"form-control\" id=\"title\" aria-describedby=\"title\">\n          </div>\n\n          <div class=\"input-group mb-3\">\n            <span class=\"input-group-text\">Author</span>\n            <input type=\"text\" class=\"form-control\" id=\"author\" aria-describedby=\"author\">\n          </div>\n\n          <div class=\"input-group mb-3\">\n            <span class=\"input-group-text\">Publisher</span>\n            <input type=\"text\" class=\"form-control\" id=\"publisher\" aria-describedby=\"publisher\">\n          </div>\n\n          <div class=\"input-group mb-3\">\n            <span class=\"input-group-text\">Year of Release</span>\n            <input type=\"text\" class=\"form-control\" id=\"yearOfRelease\" aria-describedby=\"yearOfRelease\">\n          </div>\n\n          <div class=\"input-group mb-3\">\n            <span class=\"input-group-text\">Image Location</span>\n            <input type=\"text\" class=\"form-control\" id=\"imageLocation\" aria-describedby=\"imageLocation\">\n          </div>\n\n          <div class=\"input-group mb-3\">\n            <span class=\"input-group-text\" >Description</span>\n            <input type=\"text\" class=\"form-control\" aria-describedby=\"description\" id=\"description\">\n          </div>\n\n          <!-- Upload -->\n          <div class=\"input-group mb-3\">\n            <input type=\"file\" class=\"form-control\" id=\"file\" (change)=\"selectFile($event)\">\n          </div>\n    </div>\n\n    <button class=\"btn btn-danger\" data-bs-toggle=\"modal\" data-bs-target=\"#exampleModal\">Split book?</button>\n    <button class=\"btn btn-primary mx-3\" [disabled]=\"!selectedFiles\" (click)=\"upload()\">Add book</button>\n\n</div>\n\n\n<!-- Modal -->\n<div class=\"modal fade\" id=\"exampleModal\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">Split Book into Chapters</h5>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n            <form></form>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n          <button type=\"button\" class=\"btn btn-primary\" data-bs-dismiss=\"modal\">Save changes</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <form></form>"],"sourceRoot":""},"metadata":{},"sourceType":"module"}